var logging="none";log=function(){try{if(logging){var e=Array.prototype.join.call(arguments," ");"console"==logging?console.log(e):"screen"==logging&&logToScreen(e)}}catch(e){alert("Oops...the browser has encountered the following unexpected error:\n"+e.message+"\n\nPlease try clearing your browser cache and reload the page.")}},logToScreen=function(e){var a=document.getElementById("logging");if(!a){var t=document.createElement("div");t.id="logging";var n=document.createElement("h3");n.innerHTML="Application Logs",t.appendChild(n),document.getElementsByTagName("BODY")[0].appendChild(t)}var i=document.createElement("p");i.innerHTML=e,document.getElementById("logging").appendChild(i)},window.addEventListener("online",function(e){log("Online")},!0),window.addEventListener("offline",function(e){log("Offline")},!0),showCacheStatus=function(e){return statusMessages=["Uncached","Idle","Checking","Downloading","UpdateReady","Obsolete"],statusMessages[e]},window.applicationCache.onchecking=function(e){log("Checking for application update")},window.applicationCache.onnoupdate=function(e){log("No application update found")},window.applicationCache.onobsolete=function(e){log("Application obsolete")},window.applicationCache.ondownloading=function(e){log("Downloading application update")},window.applicationCache.oncached=function(e){log("Application cached")},window.applicationCache.onupdateready=function(e){log("Application cache updated"),location.reload(!1),log("Reloaded page from cache")},window.applicationCache.onerror=function(e){navigator.onLine?log("Application cache error: ("+e.message+")"):log("Navigator is Offline")},checkForUpdates=function(){try{log("Executing window.applicationCache.update()"),window.applicationCache.update()}catch(e){log("Error has occured from executing window.applicationCache.update()"),applicationCache.onerror(e)}},onload=function(e){return window.applicationCache?window.localStorage?(log("Initial cache status: "+showCacheStatus(window.applicationCache.status)),log("Checking for cache updates from server"),void checkForUpdates()):void alert("Unfortunately Local Storage (window.localStorage) feature is not supported by your current browser. This application requires this to function properly. Please try using the latest Google Chrome browser."):void alert("Unfortunately Offline Applications (window.applicationCache) feature is not supported by your current browser. This application requires this to function properly. Please try using the latest Google Chrome browser.")},log("Initialising global constants (photoWidth and photoHeight) and variables (video, soundCamera, canvas)...");var photoWidth=640,photoHeight=480,video=document.getElementById("tempVideo"),soundCamera=document.getElementById("tempAudio"),canvas=document.getElementById("tempCanvas"),btnSaveCurrentLocation=document.getElementById("btnSaveCurrentLocation"),ctx=canvas.getContext("2d"),localMediaStream=null;canvas.width=photoHeight,canvas.height=photoWidth;var language={af:{GettingReady:"Klaar maak...",AwaitingGPS:"In afwagting van GPS...",IParkedHere:"Ek het hier geparkeer",InfoAndFeedback:"Info & terugvoer",Copyright2008:"Kopiereg @2018"},sq:{GettingReady:"Duke u bërë gati...",AwaitingGPS:"Po pritet GPS...",IParkedHere:"Kam parkuar këtu",InfoAndFeedback:"Info & Feedback",Copyright2008:"Copyright @2018"},ar:{GettingReady:"يستعد...",AwaitingGPS:"في انتظار نظام تحديد المواقع ...",IParkedHere:"أنا متوقفة هنا",InfoAndFeedback:"معلومات وملاحظات",Copyright2008:"كوبيرايت @ 2018"},eu:{GettingReady:"Prestatzen...",AwaitingGPS:"GPS zain...",IParkedHere:"Hemen aparkatuta nago",InfoAndFeedback:"Informazio eta iradokizunak",Copyright2008:"Copyright @2018"},bg:{GettingReady:"Приготвям се...",AwaitingGPS:"Очаква се GPS...",IParkedHere:"Паркирах тук",InfoAndFeedback:"Информация и обратна връзка",Copyright2008:"Copyright @2018"},be:{GettingReady:"Рыхтавацца...",AwaitingGPS:"Чаканне GPS...",IParkedHere:"Я Прыпаркаваныя Тут",InfoAndFeedback:"Інфармацыя і сувязь",Copyright2008:"Copyright @2018"},ca:{GettingReady:"Preparant-se...",AwaitingGPS:"S'està esperant el GPS...",IParkedHere:"Vaig aparcar aquí",InfoAndFeedback:"Informació i comentaris",Copyright2008:"Copyright @2018"},zh:{GettingReady:"准备好...",AwaitingGPS:"等待GPS...",IParkedHere:"我停在这里",InfoAndFeedback:"信息和反馈",Copyright2008:"版权所有@2018年"},hr:{GettingReady:"Spremiti se...",AwaitingGPS:"Čekanje na GPS...",IParkedHere:"Parkirao sam ovdje",InfoAndFeedback:"Info i povratne informacije",Copyright2008:"Autorska prava @2018"},cs:{GettingReady:"Připravovat se...",AwaitingGPS:"Čeká GPS...",IParkedHere:"Zaparkovala jsem tady",InfoAndFeedback:"Informace a zpětná vazba",Copyright2008:"Copyright @2018"},da:{GettingReady:"Gøre sig klar...",AwaitingGPS:"Afventer GPS...",IParkedHere:"Jeg parkerede her",InfoAndFeedback:"Info og tilbagemelding",Copyright2008:"Ophavsret @2018"},nl:{GettingReady:"Klaar maken...",AwaitingGPS:"In afwachting van GPS...",IParkedHere:"Ik heb hier geparkeerd",InfoAndFeedback:"Info en feedback",Copyright2008:"Copyright @2018"},en:{GettingReady:"Getting Ready...",AwaitingGPS:"Awaiting GPS...",IParkedHere:"I Parked Here",InfoAndFeedback:"Info & Feedback",Copyright2008:"Copyright @2018"},et:{GettingReady:"Valmis seadma...",AwaitingGPS:"Ootan GPS-i ...",IParkedHere:"Ma pargisin siia",InfoAndFeedback:"Info ja tagasiside",Copyright2008:"Copyright @2018"},fo:{GettingReady:"Valmis seadma...",AwaitingGPS:"Ootan GPS-i ...",IParkedHere:"Ma pargisin siia",InfoAndFeedback:"Info ja tagasiside",Copyright2008:"Copyright @2018"},fa:{GettingReady:"آماده شدن...",AwaitingGPS:"در انتظار GPS ...",IParkedHere:"من اینجا پارک کردم",InfoAndFeedback:"اطلاعات و بازخورد",Copyright2008:"Copyright @2018"},fi:{GettingReady:"Valmistautua...",AwaitingGPS:"Odotetaan GPS...",IParkedHere:"Olen pysytellyt täällä",InfoAndFeedback:"Info & Palaute",Copyright2008:"Copyright @2018"},fr:{GettingReady:"Se préparer...",AwaitingGPS:"En attente de GPS...",IParkedHere:"Je me suis garé ici",InfoAndFeedback:"Infos et commentaires",Copyright2008:"Droit d'auteur @2018"},gd:{GettingReady:"A 'faighinn deasachadh...",AwaitingGPS:"A 'feitheamh ri GPS...",IParkedHere:"Bha mi a 'pàirc an seo",InfoAndFeedback:"Fiosrachadh & fios air ais",Copyright2008:"Dlighe-sgrìobhaidh @2018"},de:{GettingReady:"Fertig werden...",AwaitingGPS:"Ich warte auf GPS...",IParkedHere:"Ich parkte hier",InfoAndFeedback:"Info und Feedback",Copyright2008:"Copyright @2018"},el:{GettingReady:"Ετοιμάζομαι...",AwaitingGPS:"Αναμονή GPS...",IParkedHere:"Εγώ παρκαρίστηκα εδώ",InfoAndFeedback:"Πληροφορίες & Ανατροφοδότηση",Copyright2008:"Πνευματικά δικαιώματα @2018"},he:{GettingReady:"מתכונן...",AwaitingGPS:"ממתין ל- GPS ...",IParkedHere:"אני חנה כאן",InfoAndFeedback:"מידע ומשוב",Copyright2008:"זכויות יוצרים @ 2018"},hi:{GettingReady:"तैयार होना...",AwaitingGPS:"जीपीएस की प्रतीक्षारत ...",IParkedHere:"मैं यहां पार्क किया",InfoAndFeedback:"जानकारी और प्रतिक्रिया",Copyright2008:"कॉपीराइट @2018"},hu:{GettingReady:"Készülődni...",AwaitingGPS:"GPS várakozás ...",IParkedHere:"Itt parkoltam",InfoAndFeedback:"Információ és visszajelzés",Copyright2008:"Copyright @2018"},is:{GettingReady:"Gera sig tilbúinn...",AwaitingGPS:"Bíður GPS...",IParkedHere:"Ég Parked Hér",InfoAndFeedback:"Upplýsingar og endurgjöf",Copyright2008:"Höfundarréttur @2018"},id:{GettingReady:"Bersiap-siap...",AwaitingGPS:"Menunggu GPS...",IParkedHere:"Aku parkir di sini",InfoAndFeedback:"Info & Tanggapan",Copyright2008:"Hak Cipta @2018"},it:{GettingReady:"Prepararsi...",AwaitingGPS:"In attesa di GPS...",IParkedHere:"Sono parcheggiato qui",InfoAndFeedback:"Informazioni e feedback",Copyright2008:"Copyright @2018"},ja:{GettingReady:"準備中...",AwaitingGPS:"GPSを待っています...",IParkedHere:"私はここに駐車した",InfoAndFeedback:"情報とフィードバック",Copyright2008:"著作権@2018"},ko:{GettingReady:"준비하기 ...",AwaitingGPS:"GPS 대기 중 ...",IParkedHere:"나는 여기에 주차했다.",InfoAndFeedback:"정보 및 피드백",Copyright2008:"저작권 @2018"},lv:{GettingReady:"Sagatavoties...",AwaitingGPS:"Gaida GPS...",IParkedHere:"Es rezervēju šeit",InfoAndFeedback:"Informācija un atsauksmes",Copyright2008:"Autortiesības @2018"},lt:{GettingReady:"Pasiruošimas...",AwaitingGPS:"Laukiama GPS...",IParkedHere:"Aš čia apsistojau",InfoAndFeedback:"Informacija ir atsiliepimai",Copyright2008:"Copyright @2018"},mk:{GettingReady:"Подготвување ...",AwaitingGPS:"Чекајќи ГПС ...",IParkedHere:"Јас паркирани овде",InfoAndFeedback:"Информации и повратни информации",Copyright2008:"Copyright @2018"},mt:{GettingReady:"Getting lest...",AwaitingGPS:"Jistennew GPS...",IParkedHere:"I ipparkjat hawn",InfoAndFeedback:"Info u Feedback",Copyright2008:"Copyright @2018"},no:{GettingReady:"Gjør seg klar...",AwaitingGPS:"Venter på GPS...",IParkedHere:"Jeg parkerte her",InfoAndFeedback:"Info og tilbakemelding",Copyright2008:"Opphavsrett @2018"},pl:{GettingReady:"Przygotowywanie się...",AwaitingGPS:"Oczekiwanie na GPS...",IParkedHere:"Zaparkowałem tutaj",InfoAndFeedback:"Informacje i opinie",Copyright2008:"Prawa autorskie @2018"},pt:{GettingReady:"Preparando-se...",AwaitingGPS:"Esperando GPS...",IParkedHere:"Eu estacionei aqui",InfoAndFeedback:"Informações e comentários",Copyright2008:"Copyright @2018"},rm:{GettingReady:"Preparando-se...",AwaitingGPS:"Esperando GPS...",IParkedHere:"Eu estacionei aqui",InfoAndFeedback:"Informações e comentários",Copyright2008:"Copyright @2018"},ro:{GettingReady:"Se pregateste...",AwaitingGPS:"În așteptarea GPS...",IParkedHere:"Am parcat aici",InfoAndFeedback:"Informații și feedback",Copyright2008:"Copyright @2018"},ru:{GettingReady:"Готовиться...",AwaitingGPS:"Ожидание GPS...",IParkedHere:"Я припарковался здесь",InfoAndFeedback:"Информация и отзывы",Copyright2008:"Copyright @2018"},sz:{GettingReady:"Готовиться...",AwaitingGPS:"Ожидание GPS...",IParkedHere:"Я припарковался здесь",InfoAndFeedback:"Информация и отзывы",Copyright2008:"Copyright @2018"},sr:{GettingReady:"Припремати се...",AwaitingGPS:"Чека ГПС ...",IParkedHere:"Ја сам паркирана овде",InfoAndFeedback:"Инфо и повратне информације",Copyright2008:"Цопиригхт @2018"},sk:{GettingReady:"Pripravovať sa...",AwaitingGPS:"Čaká sa na GPS...",IParkedHere:"Parkoval som tu",InfoAndFeedback:"Informácie a spätná väzba",Copyright2008:"Copyright @2018"},sl:{GettingReady:"Pripravljati se...",AwaitingGPS:"Čakam na GPS...",IParkedHere:"Sem parkiran tukaj",InfoAndFeedback:"Info & povratne informacije",Copyright2008:"Copyright @2018"},sb:{GettingReady:"Pripravljati se...",AwaitingGPS:"Čakam na GPS...",IParkedHere:"Sem parkiran tukaj",InfoAndFeedback:"Info & povratne informacije",Copyright2008:"Copyright @2018"},es:{GettingReady:"Preparándose ...",AwaitingGPS:"En espera de GPS...",IParkedHere:"Estacioné aquí",InfoAndFeedback:"Información y comentarios",Copyright2008:"Copyright @2018"},sx:{GettingReady:"Preparándose ...",AwaitingGPS:"En espera de GPS...",IParkedHere:"Estacioné aquí",InfoAndFeedback:"Información y comentarios",Copyright2008:"Copyright @2018"},sv:{GettingReady:"Gör mig i ordning...",AwaitingGPS:"Väntar på GPS...",IParkedHere:"Jag parkerade här",InfoAndFeedback:"Info & Feedback",Copyright2008:"Upphovsrätt @2018"},th:{GettingReady:"เตรียมพร้อม...",AwaitingGPS:"กำลังรอ GPS...",IParkedHere:"ฉันจอดที่นี่",InfoAndFeedback:"ข้อมูลและคำติชม",Copyright2008:"ลิขสิทธิ์ @2018"},ts:{GettingReady:"เตรียมพร้อม...",AwaitingGPS:"กำลังรอ GPS...",IParkedHere:"ฉันจอดที่นี่",InfoAndFeedback:"ข้อมูลและคำติชม",Copyright2008:"ลิขสิทธิ์ @2018"},tn:{GettingReady:"เตรียมพร้อม...",AwaitingGPS:"กำลังรอ GPS...",IParkedHere:"ฉันจอดที่นี่",InfoAndFeedback:"ข้อมูลและคำติชม",Copyright2008:"ลิขสิทธิ์ @2018"},tr:{GettingReady:"Hazır olmak...",AwaitingGPS:"GPS bekleniyor ...",IParkedHere:"Burada park ettim",InfoAndFeedback:"Bilgi ve Geribesleme",Copyright2008:"2018'de telif hakkı @ 2018"},uk:{GettingReady:"Готуватися, збиратись...",AwaitingGPS:"Очікування GPS...",IParkedHere:"Я припаркував тут",InfoAndFeedback:"Інформація та відгуки",Copyright2008:"Copyright @2018"},ur:{GettingReady:"Готуватися, збиратись...",AwaitingGPS:"Очікування GPS...",IParkedHere:"Я припаркував тут",InfoAndFeedback:"معلومات اور تاثرات",Copyright2008:"کاپی رائٹ @ 2018"},ve:{GettingReady:"Готуватися, збиратись...",AwaitingGPS:"Очікування GPS...",IParkedHere:"Я припаркував тут",InfoAndFeedback:"معلومات اور تاثرات",Copyright2008:"کاپی رائٹ @ 2018"},vi:{GettingReady:"Sẵn sàng...",AwaitingGPS:"Đang chờ GPS...",IParkedHere:"Tôi đậu ở đây",InfoAndFeedback:"Thông tin & phản hồi",Copyright2008:"Bản quyền @2018"},xh:{GettingReady:"Uyalungiselela...",AwaitingGPS:"Ukulinda i-GPS...",IParkedHere:"Ndimile apha",InfoAndFeedback:"Ulwazi & Impendulo",Copyright2008:"Copyright @2018"},ji:{GettingReady:"Uyalungiselela...",AwaitingGPS:"Ukulinda i-GPS...",IParkedHere:"Ndimile apha",InfoAndFeedback:"Ulwazi & Impendulo",Copyright2008:"Copyright @2018"},zu:{GettingReady:"Ngisazi Lungiselela...",AwaitingGPS:"Ilinde i-GPS...",IParkedHere:"Ngifakwe Lapha",InfoAndFeedback:"Ulwazi & Impendulo",Copyright2008:"I-copyright @2018"}};getLocalLanguage=function(sourceString){var navigatorLanguage=navigator.language;navigatorLanguageSubstringLength=navigatorLanguage.indexOf("-"),navigatorLanguageSubstringLength=0==navigatorLanguageSubstringLength?navigatorLanguage.length-1:navigatorLanguageSubstringLength,navigatorLanguage=navigatorLanguage.substring(0,navigatorLanguageSubstringLength);try{return eval("language."+navigatorLanguage+"."+sourceString)}catch(err){return eval("language.en."+sourceString)}},btnSaveCurrentLocation.innerHTML=getLocalLanguage("GettingReady");var buttonText=getLocalLanguage("IParkedHere");document.getElementById("InfoAndFeedback").innerHTML=getLocalLanguage("InfoAndFeedback"),document.getElementById("Copyright2008").innerHTML=getLocalLanguage("Copyright2008"),animateBtnSaveCurrentLocation=function(e){e==buttonText?(btnSaveCurrentLocation.disabled=!1,btnSaveCurrentLocation.style.backgroundColor="#000000",btnSaveCurrentLocation.style.color="#ffffff"):(btnSaveCurrentLocation.disabled=!0,btnSaveCurrentLocation.style.backgroundColor="#ffffff",btnSaveCurrentLocation.style.color="#000000"),btnSaveCurrentLocation.innerHTML=e},saveCurrentLocation=function(){navigator.geolocation?(animateBtnSaveCurrentLocation(getLocalLanguage("AwaitingGPS")),soundCamera.play(),navigator.geolocation.getCurrentPosition(showPosition)):(log("Undefined navigator.geolocation"),alert("Unfortunately GPS (navigator.geolocation) feature is not supported by your current browser. This application requires this to function properly. Please try using the latest Google Chrome browser."))},getCurrentDateTime=function(){return new Date},renderDateTime=function(e){var a=navigator.language,t={weekday:"long",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"},n=Date.parse(e)?new Date(e).toLocaleString(a,t):e;return n},setVideoSrc=function(e){var a=document.querySelector("video");"srcObject"in a?a.srcObject=e:a.src=window.URL.createObjectURL(e),localMediaStream=e,localMediaStream&&(a.style.display="block")},getUserMedia=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){var e={audio:!1,video:{width:photoWidth,height:photoHeight,facingMode:"environment"}};navigator.mediaDevices.getUserMedia(e).then(setVideoSrc).catch(log)}else if(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia){var e={audio:!1,video:{width:photoWidth,height:photoHeight,facingMode:{exact:"environment"}}};navigator.getUserMedia(e,setVideoSrc,log)}else log("Undefined navigator.getUserMedia"),alert("Unfortunately Photo Capture (navigator.getUserMedia) feature is not supported by your current browser. This application requires this to function properly. Please try using the latest Google Chrome browser.")},getPhotoFromCanvas=function(){return localMediaStream?(ctx.drawImage(video,0,0,photoHeight,photoWidth),canvas.toDataURL("image/webp")):null},showPosition=function(e){var a=getCurrentDateTime();storeLocation(a,e.coords.latitude,e.coords.longitude,getPhotoFromCanvas()),showLocationHistory()},storeLocation=function(e,a,t,n){var i=JSON.parse(localStorage.locations||"[]");i.push({datetime:e,latitude:a,longitude:t,photo:n}),localStorage.locations=JSON.stringify(i),log("Stored currentDateTime, geolocation, photo to localStorage.locations"),animateBtnSaveCurrentLocation(buttonText)},showLocationHistory=function(){var e=JSON.parse(localStorage.locations||"[]"),a=document.getElementById("locationHistory");if(e.length>0){a.style.display="";for(var t=document.getElementById("locationHistoryBody");t.hasChildNodes();)t.removeChild(t.firstChild)}else a.style.display="none";for(i=e.length-1;i>=0;i--){var n=document.createElement("tr");n.setAttribute("id","row"+i);var o=document.createElement("td");o=document.createElement("td"),o.innerHTML='<a onclick="javascript:clearLocation('+i+')"><img src="media/iconDelete.png" alt="Delete" height="40" /></a>',o.className="center no-lrpadding",n.appendChild(o),o=document.createElement("td"),o.innerHTML=renderDateTime(e[i].datetime),o.className="breakword",n.appendChild(o),o=document.createElement("td"),o.innerHTML='<a href="https://maps.google.com/maps?q='+e[i].latitude+"+"+e[i].longitude+"&hl="+navigator.language+'">'+e[i].latitude+","+e[i].longitude+"</a>",o.className="breakword",n.appendChild(o),o=document.createElement("td"),o.innerHTML=e[i].photo?'<img class="photo" src="'+e[i].photo+'" width="100%" />':"",o.className="center",n.appendChild(o),t.appendChild(n)}},reloadPage=function(){location.reload()},clearLocationHistory=function(){window.localStorage&&window.localStorage.locations&&confirm("Permanently DELETE ALL rows from the table?")&&(localStorage.removeItem("locations"),log("Removed localStorage.locations"),showLocationHistory())},clearLocation=function(e){if(window.localStorage&&window.localStorage.locations){var a=JSON.parse(localStorage.locations||"[]");a.splice(e,1),localStorage.locations=JSON.stringify(a),log("Removed localStorage.locations["+e+"]"),showLocationHistory()}},log("Update text on '"+buttonText+"' button"),animateBtnSaveCurrentLocation(buttonText),log("Binding '"+buttonText+"' button and 'Delete ALL Location History' icon click event handlers"),document.getElementById("btnSaveCurrentLocation").onclick=saveCurrentLocation,document.getElementById("btnClearLocationHistory").onclick=clearLocationHistory,log("Rendering Location History table"),showLocationHistory(),log("Initiating Video and Canvas"),getUserMedia(),log("Application is ready");