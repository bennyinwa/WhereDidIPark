var logging="none";log=function(){try{if(logging){var e=Array.prototype.join.call(arguments," ");"console"==logging?console.log(e):"screen"==logging&&logToScreen(e)}}catch(e){alert("Oops...the browser has encountered the following unexpected error:\n"+e.message+"\n\nPlease try clearing your browser cache and reload the page.")}},logToScreen=function(e){var o=document.getElementById("logging");if(!o){var a=document.createElement("div");a.id="logging";var t=document.createElement("h3");t.innerHTML="Application Logs",a.appendChild(t),document.getElementsByTagName("BODY")[0].appendChild(a)}var n=document.createElement("p");n.innerHTML=e,document.getElementById("logging").appendChild(n)},window.addEventListener("online",function(e){log("Online")},!0),window.addEventListener("offline",function(e){log("Offline")},!0),showCacheStatus=function(e){return statusMessages=["Uncached","Idle","Checking","Downloading","UpdateReady","Obsolete"],statusMessages[e]},window.applicationCache.onchecking=function(e){log("Checking for application update")},window.applicationCache.onnoupdate=function(e){log("No application update found")},window.applicationCache.onobsolete=function(e){log("Application obsolete")},window.applicationCache.ondownloading=function(e){log("Downloading application update")},window.applicationCache.oncached=function(e){log("Application cached")},window.applicationCache.onupdateready=function(e){log("Application cache updated"),location.reload(!1),log("Reloaded page from cache")},window.applicationCache.onerror=function(e){navigator.onLine?log("Application cache error: ("+e.message+")"):log("Navigator is Offline")},checkForUpdates=function(){try{log("Executing window.applicationCache.update()"),window.applicationCache.update()}catch(e){log("Error has occured from executing window.applicationCache.update()"),applicationCache.onerror(e)}},onload=function(e){return window.applicationCache?window.localStorage?(log("Initial cache status: "+showCacheStatus(window.applicationCache.status)),log("Checking for cache updates from server"),void checkForUpdates()):void alert("Unfortunately Local Storage (window.localStorage) feature is not supported by your current browser. This application requires this to function properly. Please try using the latest Google Chrome browser."):void alert("Unfortunately Offline Applications (window.applicationCache) feature is not supported by your current browser. This application requires this to function properly. Please try using the latest Google Chrome browser.")},log("Initialising global constants (photoWidth and photoHeight) and variables (video, soundCamera, canvas)...");var photoWidth=640,photoHeight=480,video=document.getElementById("tempVideo"),soundCamera=document.getElementById("tempAudio"),canvas=document.getElementById("tempCanvas"),btnSaveCurrentLocation=document.getElementById("btnSaveCurrentLocation"),ctx=canvas.getContext("2d"),localMediaStream=null;canvas.width=photoHeight,canvas.height=photoWidth;var language={af:{IParkedHere:"Ek het hier geparkeer",InfoAndFeedback:"Info & terugvoer",Copyright2008:"Kopiereg @2018"},sq:{IParkedHere:"Ek het hier geparkeer",InfoAndFeedback:"Info & terugvoer",Copyright2008:"Kopiereg @2018"},ar:{IParkedHere:"أنا متوقفة هنا",InfoAndFeedback:"معلومات وملاحظات",Copyright2008:"كوبيرايت @ 2018"},eu:{IParkedHere:"Hemen aparkatuta nago",InfoAndFeedback:"Informazio eta iradokizunak",Copyright2008:"Copyright @2018"},bg:{IParkedHere:"Паркирах тук",InfoAndFeedback:"Информация и обратна връзка",Copyright2008:"Copyright @2018"},be:{IParkedHere:"Я Прыпаркаваныя Тут",InfoAndFeedback:"Інфармацыя і сувязь",Copyright2008:"Copyright @2018"},ca:{IParkedHere:"Vaig aparcar aquí",InfoAndFeedback:"Informació i comentaris",Copyright2008:"Copyright @2018"},zh:{IParkedHere:"我停在这里",InfoAndFeedback:"信息和反馈",Copyright2008:"版权所有@2018年"},hr:{IParkedHere:"Parkirao sam ovdje",InfoAndFeedback:"Info i povratne informacije",Copyright2008:"Autorska prava @2018"},cs:{IParkedHere:"Zaparkovala jsem tady",InfoAndFeedback:"Informace a zpětná vazba",Copyright2008:"Copyright @2018"},da:{IParkedHere:"Jeg parkerede her",InfoAndFeedback:"Info og tilbagemelding",Copyright2008:"Ophavsret @2018"},nl:{IParkedHere:"Ik heb hier geparkeerd",InfoAndFeedback:"Info en feedback",Copyright2008:"Copyright @2018"},en:{IParkedHere:"I Parked Here",InfoAndFeedback:"Info & Feedback",Copyright2008:"Copyright @2018"},et:{IParkedHere:"Ma pargisin siia",InfoAndFeedback:"Info ja tagasiside",Copyright2008:"Copyright @2018"},fo:{IParkedHere:"Ma pargisin siia",InfoAndFeedback:"Info ja tagasiside",Copyright2008:"Copyright @2018"},fa:{IParkedHere:"من اینجا پارک کردم",InfoAndFeedback:"اطلاعات و بازخورد",Copyright2008:"Copyright @2018"},fi:{IParkedHere:"Olen pysytellyt täällä",InfoAndFeedback:"Info & Palaute",Copyright2008:"Copyright @2018"},fr:{IParkedHere:"Je me suis garé ici",InfoAndFeedback:"Infos et commentaires",Copyright2008:"Droit d'auteur @2018"},gd:{IParkedHere:"Bha mi a 'pàirc an seo",InfoAndFeedback:"Fiosrachadh & fios air ais",Copyright2008:"Dlighe-sgrìobhaidh @2018"},de:{IParkedHere:"Ich parkte hier",InfoAndFeedback:"Info und Feedback",Copyright2008:"Copyright @2018"},el:{IParkedHere:"Εγώ παρκαρίστηκα εδώ",InfoAndFeedback:"Πληροφορίες & Ανατροφοδότηση",Copyright2008:"Πνευματικά δικαιώματα @2018"},he:{IParkedHere:"אני חנה כאן",InfoAndFeedback:"מידע ומשוב",Copyright2008:"זכויות יוצרים @ 2018"},hi:{IParkedHere:"मैं यहां पार्क किया",InfoAndFeedback:"जानकारी और प्रतिक्रिया",Copyright2008:"कॉपीराइट @2018"},hu:{IParkedHere:"Itt parkoltam",InfoAndFeedback:"Információ és visszajelzés",Copyright2008:"Copyright @2018"},is:{IParkedHere:"Ég Parked Hér",InfoAndFeedback:"Upplýsingar og endurgjöf",Copyright2008:"Höfundarréttur @2018"},id:{IParkedHere:"Aku parkir di sini",InfoAndFeedback:"Info & Tanggapan",Copyright2008:"Hak Cipta @2018"},it:{IParkedHere:"Sono parcheggiato qui",InfoAndFeedback:"Informazioni e feedback",Copyright2008:"Copyright @2018"},ja:{IParkedHere:"私はここに駐車した",InfoAndFeedback:"情報とフィードバック",Copyright2008:"著作権@2018"},ko:{IParkedHere:"나는 여기에 주차했다.",InfoAndFeedback:"정보 및 피드백",Copyright2008:"저작권 @2018"},lv:{IParkedHere:"Es rezervēju šeit",InfoAndFeedback:"Informācija un atsauksmes",Copyright2008:"Autortiesības @2018"},lt:{IParkedHere:"Aš čia apsistojau",InfoAndFeedback:"Informacija ir atsiliepimai",Copyright2008:"Copyright @2018"},mk:{IParkedHere:"Јас паркирани овде",InfoAndFeedback:"Информации и повратни информации",Copyright2008:"Copyright @2018"},mt:{IParkedHere:"I ipparkjat hawn",InfoAndFeedback:"Info u Feedback",Copyright2008:"Copyright @2018"},no:{IParkedHere:"Jeg parkerte her",InfoAndFeedback:"Info og tilbakemelding",Copyright2008:"Opphavsrett @2018"},pl:{IParkedHere:"Zaparkowałem tutaj",InfoAndFeedback:"Informacje i opinie",Copyright2008:"Prawa autorskie @2018"},pt:{IParkedHere:"Eu estacionei aqui",InfoAndFeedback:"Informações e comentários",Copyright2008:"Copyright @2018"},rm:{IParkedHere:"Eu estacionei aqui",InfoAndFeedback:"Informações e comentários",Copyright2008:"Copyright @2018"},ro:{IParkedHere:"Am parcat aici",InfoAndFeedback:"Informații și feedback",Copyright2008:"Copyright @2018"},ru:{IParkedHere:"Я припарковался здесь",InfoAndFeedback:"Информация и отзывы",Copyright2008:"Copyright @2018"},sz:{IParkedHere:"Я припарковался здесь",InfoAndFeedback:"Информация и отзывы",Copyright2008:"Copyright @2018"},sr:{IParkedHere:"Ја сам паркирана овде",InfoAndFeedback:"Инфо и повратне информације",Copyright2008:"Цопиригхт @2018"},sk:{IParkedHere:"Parkoval som tu",InfoAndFeedback:"Informácie a spätná väzba",Copyright2008:"Copyright @2018"},sl:{IParkedHere:"Sem parkiran tukaj",InfoAndFeedback:"Info & povratne informacije",Copyright2008:"Copyright @2018"},sb:{IParkedHere:"Sem parkiran tukaj",InfoAndFeedback:"Info & povratne informacije",Copyright2008:"Copyright @2018"},es:{IParkedHere:"Estacioné aquí",InfoAndFeedback:"Información y comentarios",Copyright2008:"Copyright @2018"},sx:{IParkedHere:"Estacioné aquí",InfoAndFeedback:"Información y comentarios",Copyright2008:"Copyright @2018"},sv:{IParkedHere:"Jag parkerade här",InfoAndFeedback:"Info & Feedback",Copyright2008:"Upphovsrätt @2018"},th:{IParkedHere:"ฉันจอดที่นี่",InfoAndFeedback:"ข้อมูลและคำติชม",Copyright2008:"ลิขสิทธิ์ @2018"},ts:{IParkedHere:"ฉันจอดที่นี่",InfoAndFeedback:"ข้อมูลและคำติชม",Copyright2008:"ลิขสิทธิ์ @2018"},tn:{IParkedHere:"ฉันจอดที่นี่",InfoAndFeedback:"ข้อมูลและคำติชม",Copyright2008:"ลิขสิทธิ์ @2018"},tr:{IParkedHere:"Burada park ettim",InfoAndFeedback:"Bilgi ve Geribesleme",Copyright2008:"2018'de telif hakkı @ 2018"},uk:{IParkedHere:"Я припаркував тут",InfoAndFeedback:"Інформація та відгуки",Copyright2008:"Copyright @2018"},ur:{IParkedHere:"Я припаркував тут",InfoAndFeedback:"معلومات اور تاثرات",Copyright2008:"کاپی رائٹ @ 2018"},ve:{IParkedHere:"Я припаркував тут",InfoAndFeedback:"معلومات اور تاثرات",Copyright2008:"کاپی رائٹ @ 2018"},vi:{IParkedHere:"Tôi đậu ở đây",InfoAndFeedback:"Thông tin & phản hồi",Copyright2008:"Bản quyền @2018"},xh:{IParkedHere:"Tôi đậu ở đây",InfoAndFeedback:"Thông tin & phản hồi",Copyright2008:"Bản quyền @2018"},ji:{IParkedHere:"Tôi đậu ở đây",InfoAndFeedback:"Thông tin & phản hồi",Copyright2008:"Bản quyền @2018"},zu:{IParkedHere:"Ngifakwe Lapha",InfoAndFeedback:"Ulwazi & Impendulo",Copyright2008:"I-copyright @2018"}};getLocalLanguage=function(sourceString){var navigatorLanguage=navigator.language;navigatorLanguageSubstringLength=navigatorLanguage.indexOf("-"),navigatorLanguageSubstringLength=0==navigatorLanguageSubstringLength?navigatorLanguage.length-1:navigatorLanguageSubstringLength,navigatorLanguage=navigatorLanguage.substring(0,navigatorLanguageSubstringLength);try{return eval("language."+navigatorLanguage+"."+sourceString)}catch(err){return eval("language.en."+sourceString)}};var buttonText=getLocalLanguage("IParkedHere");document.title=buttonText,document.getElementById("InfoAndFeedback").innerHTML=getLocalLanguage("InfoAndFeedback"),document.getElementById("Copyright2008").innerHTML=getLocalLanguage("Copyright2008"),animateBtnSaveCurrentLocation=function(e){e==buttonText?(btnSaveCurrentLocation.disabled=!1,btnSaveCurrentLocation.style.backgroundColor="#000000",btnSaveCurrentLocation.style.color="#ffffff"):(btnSaveCurrentLocation.disabled=!0,btnSaveCurrentLocation.style.backgroundColor="#ffffff",btnSaveCurrentLocation.style.color="#000000"),btnSaveCurrentLocation.innerHTML=e},saveCurrentLocation=function(){navigator.geolocation?(animateBtnSaveCurrentLocation("Awaiting GPS..."),soundCamera.play(),navigator.geolocation.getCurrentPosition(showPosition)):(log("Undefined navigator.geolocation"),alert("Unfortunately GPS (navigator.geolocation) feature is not supported by your current browser. This application requires this to function properly. Please try using the latest Google Chrome browser."))},getCurrentDateTime=function(){return new Date},renderDateTime=function(e){var o=navigator.language,a={weekday:"long",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"},t=Date.parse(e)?new Date(e).toLocaleString(o,a):e;return t},setVideoSrc=function(e){var o=document.querySelector("video");"srcObject"in o?o.srcObject=e:o.src=window.URL.createObjectURL(e),localMediaStream=e},getUserMedia=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){var e={audio:!1,video:{width:photoWidth,height:photoHeight,facingMode:"environment"}};navigator.mediaDevices.getUserMedia(e).then(setVideoSrc).catch(log)}else if(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia){var e={audio:!1,video:{width:photoWidth,height:photoHeight,facingMode:{exact:"environment"}}};navigator.getUserMedia(e,setVideoSrc,log)}else log("Undefined navigator.getUserMedia"),alert("Unfortunately Photo Capture (navigator.getUserMedia) feature is not supported by your current browser. This application requires this to function properly. Please try using the latest Google Chrome browser.")},getPhotoFromCanvas=function(){return localMediaStream?(ctx.drawImage(video,0,0,photoHeight,photoWidth),canvas.toDataURL("image/webp")):null},showPosition=function(e){var o=getCurrentDateTime();storeLocation(o,e.coords.latitude,e.coords.longitude,getPhotoFromCanvas()),showLocationHistory()},storeLocation=function(e,o,a,t){var n=JSON.parse(localStorage.locations||"[]");n.push({datetime:e,latitude:o,longitude:a,photo:t}),localStorage.locations=JSON.stringify(n),log("Stored currentDateTime, geolocation, photo to localStorage.locations"),animateBtnSaveCurrentLocation(buttonText)},showLocationHistory=function(){var e=JSON.parse(localStorage.locations||"[]"),o=document.getElementById("locationHistory");if(e.length>0){o.style.display="";for(var a=document.getElementById("locationHistoryBody");a.hasChildNodes();)a.removeChild(a.firstChild)}else o.style.display="none";for(i=e.length-1;i>=0;i--){var t=document.createElement("tr");t.setAttribute("id","row"+i);var n=document.createElement("td");n=document.createElement("td"),n.innerHTML='<a onclick="javascript:clearLocation('+i+')"><img src="media/iconDelete.png" alt="Delete" height="40" /></a>',n.className="center no-lrpadding",t.appendChild(n),n=document.createElement("td"),n.innerHTML=renderDateTime(e[i].datetime),n.className="breakword",t.appendChild(n),n=document.createElement("td"),n.innerHTML='<a href="https://maps.google.com/maps?q='+e[i].latitude+"+"+e[i].longitude+"&hl="+navigator.language+'">'+e[i].latitude+","+e[i].longitude+"</a>",n.className="breakword",t.appendChild(n),n=document.createElement("td"),n.innerHTML=e[i].photo?'<img class="photo" src="'+e[i].photo+'" width="100%" />':"",n.className="center",t.appendChild(n),a.appendChild(t)}},reloadPage=function(){location.reload()},clearLocationHistory=function(){window.localStorage&&window.localStorage.locations&&confirm("Permanently DELETE ALL rows from the table?")&&(localStorage.removeItem("locations"),log("Removed localStorage.locations"),showLocationHistory())},clearLocation=function(e){if(window.localStorage&&window.localStorage.locations){var o=JSON.parse(localStorage.locations||"[]");o.splice(e,1),localStorage.locations=JSON.stringify(o),log("Removed localStorage.locations["+e+"]"),showLocationHistory()}},log("Update text on '"+buttonText+"' button"),animateBtnSaveCurrentLocation(buttonText),log("Binding '"+buttonText+"' button and 'Delete ALL Location History' icon click event handlers"),document.getElementById("btnSaveCurrentLocation").onclick=saveCurrentLocation,document.getElementById("btnClearLocationHistory").onclick=clearLocationHistory,log("Rendering Location History table"),showLocationHistory(),log("Initiating Video and Canvas"),getUserMedia(),log("Application is ready");